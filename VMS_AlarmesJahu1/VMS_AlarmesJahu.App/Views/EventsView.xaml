<UserControl x:Class="VMS_AlarmesJahu.App.Views.EventsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock Text="ðŸš¨ HistÃ³rico de Eventos" FontSize="24" FontWeight="Bold"/>
            <TextBlock Text="Todos os eventos de detecÃ§Ã£o registrados" Opacity="0.7"/>
        </StackPanel>

        <!-- Filtros -->
        <Border Grid.Row="1" Style="{DynamicResource CardBorder}" Padding="16" Margin="0,0,0,16">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="PerÃ­odo:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <DatePicker x:Name="DpStart" Width="120" Margin="0,0,8,0"/>
                    <TextBlock Text="atÃ©" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <DatePicker x:Name="DpEnd" Width="120" Margin="0,0,16,0"/>

                    <TextBlock Text="Dispositivo:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <ComboBox x:Name="CbDevice" Width="150" Margin="0,0,16,0" DisplayMemberPath="Name"/>

                    <Button x:Name="BtnSearch" Content="ðŸ” Buscar" Padding="16,6" Margin="0,0,8,0"/>
                    <Button x:Name="BtnExport" Content="ðŸ“¥ Exportar CSV" Padding="16,6"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <TextBlock x:Name="TxtCount" Text="0 eventos" VerticalAlignment="Center" Opacity="0.7"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Lista de Eventos -->
        <Border Grid.Row="2" Style="{DynamicResource CardBorder}">
            <DataGrid x:Name="DgEvents" 
                      AutoGenerateColumns="False" 
                      IsReadOnly="True"
                      Background="Transparent"
                      BorderThickness="0"
                      GridLinesVisibility="Horizontal"
                      HeadersVisibility="Column"
                      CanUserResizeRows="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Data/Hora" Binding="{Binding TimeDisplay}" Width="140"/>
                    <DataGridTextColumn Header="Dispositivo" Binding="{Binding DeviceName}" Width="120"/>
                    <DataGridTextColumn Header="Canal" Binding="{Binding ChannelDisplay}" Width="60"/>
                    <DataGridTextColumn Header="Classe" Binding="{Binding ClassName}" Width="100"/>
                    <DataGridTextColumn Header="Conf." Binding="{Binding ConfidenceDisplay}" Width="60"/>
                    <DataGridTextColumn Header="Tipo" Binding="{Binding EventType}" Width="60"/>
                    <DataGridTextColumn Header="Regra" Binding="{Binding RuleName}" Width="150"/>
                    <DataGridTemplateColumn Header="Snapshot" Width="80">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="ðŸ‘ï¸" Click="BtnViewSnapshot_Click" 
                                        Tag="{Binding SnapshotPath}" 
                                        Visibility="{Binding SnapshotPath, Converter={StaticResource NullToVisibilityConverter}}"
                                        Padding="8,2"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridCheckBoxColumn Header="âœ“" Binding="{Binding Acknowledged}" Width="40"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </Grid>
</UserControl>
